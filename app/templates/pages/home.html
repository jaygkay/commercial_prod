{% extends "layouts/layout.html" %}

{% block content %}
<body>
    <div class = "d-flex flex-column flex-shrink-0 p-3 light-mode light-text" style = "width:100%;" >

        <div class = "container-fluid d-flex">
            <a class = "d-flex align-items-center mb-3 mb-md-0 me-md-auto light-text text-decoration-none">
                <h1 class = "fs-2 light-text"> MEMO PATCH STATUS</h1>
            </a>
            <img class = "rounded float-end" src="{{url_for('static', filename='img/huinno_logo.png')}}" style = "width:311px; height:40px;">
        </div>

        <div><hr class = "light-hr"></div>

        <div class="row light-text mb-4">
            <h4 class = "fs-3">Hospitals & Doctors</h4>
            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-primary"><h2 class="mb-0">코딩 병원수</h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{code_cnt}} 곳</h3></div>
                    </div>
                </div>
            </div>

            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-primary"><h2 class="mb-0"> 처방 병원수</h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{hosp_cnt}} 곳</h3></div>
                    </div>
                </div>
            </div>

            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-primary"><h2 class="mb-0"> 처방 의사수</h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{doct_cnt}} 명</h3></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row light-text mb-4">
            <h4 class = "fs-3">Patch Test</h4>
            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-primary"><h2 class="mb-0">누적 처방수</h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{prsc_cnt}} 건</h3></div>
                    </div>
                </div>
            </div>

            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-primary"><h2 class="mb-0"> 누적 업로드수</h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{upld_cnt}} 건</h3></div>
                    </div>
                </div>
            </div>

            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-primary"><h2 class="mb-0"> 누적 레포트수</h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{rept_cnt}} 건</h3></div>
                    </div>
                </div>
            </div>
        </div>


        <div class="row light-text mb-4">
            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-primary">
                            <h2 class="mb-0"><a href="{{url_for('page_no_test')}}">검사 취소건</a></h2>
                        </div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{no_test_size}} 건</h3></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row light-text mb-4">
            <h4 class = "fs-3">Devices</h4>
            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-primary"><h2 class="mb-0"> 기기 누적 출고수</h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{tot_cumm_cnt}} 기</h3></div>
                        <div class="text-end text-secondary">
                            <span class="text-success text-sm font-weight-bolder">
                                {{tot_cumm_pct}}% out of {{tot_cumm_cnt}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-warning"><h2 class="mb-0"> 정상 등록수</h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{tot_valid_cnt}} 기</h3></div>
                        <div class="text-end text-secondary">
                            <span class="text-success text-sm font-weight-bolder">
                                {{tot_valid_pct}} % out of {{tot_cumm_cnt}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-warning"><h2 class="mb-0"> 정상 교품수 </h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{tot_repl_cnt}} 기</h3></div>
                        <div class="text-end text-secondary">
                            <span class="text-success text-sm font-weight-bolder">
                                {{tot_repl_pct}} % out of {{tot_cumm_cnt}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="row light-text mb-4">
            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-danger"><h2 class="mb-0">사용 기기수 </h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{tot_active_cnt or ''}} 기</h3></div>
                        <div class="text-end text-secondary">
                            <span class="text-success text-sm font-weight-bolder">
                                {{tot_active_pct}} % out of {{tot_cumm_cnt}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-danger"><h2 class="mb-0">미사용 기기수</h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{tot_nonact_cnt}} 기</h3></div>
                        <span class="text-success text-sm font-weight-bolder">
                                {{tot_nonact_pct}} % out of {{tot_cumm_cnt}}
                            </span>
                    </div>
                </div>
            </div>

            <div class="col-xl-4 col-sm-6 mb-xl-0 mb-4">
                <div class="card h-100">
                    <div class="card-header h-100 p-3 pt-2">
                        <div class="text-start pt-2 text-dark"><h2 class="mb-0">마케팅 / 유한 미등록 기기수 </h2></div>
                        <div class="text-end text-secondary"><h3 class="mb-0">{{no_rec_cnt}} 기</h3></div>
                        <div class="text-end text-secondary">
                            <span class="text-success text-sm font-weight-bolder">
                                {{no_rec_pct}}% out of {{tot_cumm_cnt}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div><hr class = "light-hr"></div>

    </div>
</body>

<script>
    $(document).ready(function() {
        $(".search").keyup(function() {
            var searchTerm = $(this).val();
            var searchSplit = searchTerm.replace(/ /g, "'):containsi('")

            $.extend($.expr[':'], {'containsi': function(elem, i, match, array) {
                return (elem.textContent || elem.innerText || '').toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
            }});

            $(".results tbody tr").not(":containsi('" + searchSplit + "')").each(function(e) {
                $(this).attr('visible', 'false');
            });

            $(".results tbody tr:containsi('" + searchSplit + "')").each(function(e) {
                $(this).attr('visible', 'true');
            });

            var jobCount = $('.results tbody tr[visible="true"]').length;
            $('.counter').text(jobCount + ' item');

            if (jobCount == '0') {
                $('.no-result').show();
            } else {
                $('.no-result').hide();
            }
        });

        // DataTables 초기화
        $('.results').DataTable();
    });
</script>

{% endblock content%}
